### 0x00 前言

我想做一个类似于[网易蜂巢](https://c.163.com/hub#/m/home/)的docker hub以及腾讯云容器服务这样的网站。做一个分布式的docker registry自治系统。

用户可以通过网页端：

* 注册及登录
* 创建自己的docker namespace（命名空间）
* 通过上传的或者从GitHub等代码平台导入的Dockerfile来进行远程镜像构建
* 对镜像进行权限管理，包括私有、共有
* 对镜像的描述信息以及不同tag之间的描述信息进行管理，最好支持Markdown语法

用户可以通过docker client进行：

* 使用docker pull命令从我的自治系统pull镜像

* 使用docker tag和docker push命令向我的自治系统中他们所注册的命名空间内push镜像

* 使用docker login命令登陆自治系统

  > 注：依据其官方文档，docker login命令会使用明文存放密码，所以docker login命令所使用的登陆密码需和登陆自治系统所使用的密码不一样（二重验证密码）
  >
  > https://docs.docker.com/engine/reference/commandline/login/#credentials-store

亟待解决的问题和技术壁垒：

* Java后端程序和docker的交互问题，目前的思路是基于docker的HTTP Rest API系统进一步封装自己的访问库
* 分布式系统中，Java后端程序不能和docker registry服务器放在同一台主机上，要做到Java后端程序、docker registry、registry存储的镜像，三者之间的隔离
* 基于Dockerfile的远程镜像构建没有思路，如何返回docker在进行镜像构建时的输出内容，以及出错了怎么办？？？
* 能不能把docker registry的登陆凭据内容分割出来处理（这点前人没有做过，可实现性未知），最好能放在Redis内存数据库中，加快授权、鉴权的速度，如果现实的话，能不能将Spring Security和docker registry的授权鉴权机制融合在一起（这点前人也没有做过，可实现性未知）
* 用户多了，上传的image也就多了，如何让存放这些image的docker registry从逻辑上看起来是1个，从物理上看起来是多个呢？？？这点前人肯定做过，但我还没查到相关的资料